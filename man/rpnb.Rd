% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rpnb.R
\name{rpnb}
\alias{rpnb}
\title{Estimate a Random Parameters Negative Binomial Model}
\usage{
rpnb(
  formula,
  rpar_formula,
  data,
  panel = NULL,
  form = "nb2",
  rpardists = NULL,
  ndraws = 1500,
  scrambled = FALSE,
  correlated = FALSE,
  method = "BHHH",
  max.iters = 1000,
  start.vals = NULL,
  print.level = 0
)
}
\arguments{
\item{formula}{A standard R formula for the model's fixed parameters.}

\item{rpar_formula}{A one-sided formula specifying the random parameters (e.g., `~ var1 + var2`).}

\item{data}{A data frame containing the variables for the model.}

\item{panel}{## >> A character string specifying the column name in `data` that
identifies the panel groups (e.g., individuals). If `NULL` (the default),
each observation is treated as a separate panel (cross-sectional data).}

\item{form}{The negative binomial form: `"nb2"`, `"nb1"`, or `"nbp"`.}

\item{rpardists}{An optional named character vector specifying the distribution
for each random parameter. Options: `"n"` (normal), `"ln"` (log-normal),
`"t"` (triangular), `"u"` (uniform), `"g"` (gamma). Defaults to normal for all.}

\item{ndraws}{The number of Halton draws for simulation.}

\item{scrambled}{Logical. If `TRUE`, uses scrambled Halton draws.}

\item{correlated}{Logical. If `TRUE`, estimates correlated random parameters
(forces all to be normally distributed).}

\item{method}{The optimization algorithm to be used by `maxLik::maxLik`.}

\item{max.iters}{Maximum number of iterations for the optimizer.}

\item{start.vals}{An optional named vector of starting values.}

\item{print.level}{Verbosity level for the optimization process (0, 1, or 2).}
}
\value{
A list object of class `rpnb` containing the model results, including
  coefficients, variance-covariance matrix, log-likelihood, and other model details.
}
\description{
Estimates a random parameters negative binomial (RPNB) model using maximum
simulated likelihood. Supports NB-1, NB-2, and NB-P specifications,
correlated or uncorrelated random parameters, various parameter distributions,
and panel data structures.
}
\examples{
\donttest{

## Random Parameters Negative Binomial model (NB-1)
data("washington_roads")
nb1.rp <- rpnb(Total_crashes ~ - 1 + lnlength + lnaadt,
               rpar_formula = ~ speed50,
               data = washington_roads,
               ndraws = 100,
               correlated = FALSE,
               rpardists = c(intercept="u", speed50="t"),
               form = 'nb1',
               method = "bfgs",
               print.level = 2)

summary(nb1.rp)

## Random Parameters Negative Binomial model (NB-2)
nb2.rp <- rpnb(Total_crashes ~ - 1 + lnlength + lnaadt,
               rpar_formula = ~ speed50,
               data = washington_roads,
               ndraws = 100,
               correlated = TRUE,
               form = 'nb2',
               method = "bfgs",
               print.level = 1)

summary(nb2.rp)

## Random Parameters Negative Binomial model (NB-P)
nbp.rp <- rpnb(Total_crashes ~ - 1 + lnlength + lnaadt,
               rpar_formula = ~ speed50,
               data = washington_roads,
               rpardists = c(intercept = "u", speed50 = "n"),
               ndraws = 100,
               correlated = FALSE,
               form = 'nbp',
               method = "bfgs",
               print.level = 1)

summary(nbp.rp)

## Random Parameters Negative Binomial model (NB-2) with panel
nb2.rp <- rpnb(Total_crashes ~ - 1 + lnlength + lnaadt,
               rpar_formula = ~ speed50,
               data = washington_roads,
               ndraws = 100,
               correlated = TRUE,
               form = 'nb2',
               panel = "ID",
               method = "bfgs",
               print.level = 1)

summary(nb2.rp)}
}
