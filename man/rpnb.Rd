% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rpnb.R
\name{rpnb}
\alias{rpnb}
\title{Estimate a Random Parameters Negative Binomial Model}
\usage{
rpnb(
  formula,
  rpar_formula,
  data,
  panel = NULL,
  form = "nb2",
  rpardists = NULL,
  ndraws = 1500,
  scrambled = FALSE,
  correlated = FALSE,
  method = "BHHH",
  max.iters = 1000,
  start.vals = NULL,
  print.level = 0
)
}
\arguments{
\item{formula}{A standard R formula for the model's fixed parameters.}

\item{rpar_formula}{A one-sided formula specifying the random parameters (e.g., `~ var1 + var2`).}

\item{data}{A data frame containing the variables for the model.}

\item{panel}{## >> A character string specifying the column name in `data` that
identifies the panel groups (e.g., individuals). If `NULL` (the default),
each observation is treated as a separate panel (cross-sectional data).}

\item{form}{The negative binomial form: `"nb2"`, `"nb1"`, or `"nbp"`.}

\item{rpardists}{An optional named character vector specifying the distribution
for each random parameter. Options: `"n"` (normal), `"ln"` (log-normal),
`"t"` (triangular), `"u"` (uniform), `"g"` (gamma). Defaults to normal for all.}

\item{ndraws}{The number of Halton draws for simulation.}

\item{scrambled}{Logical. If `TRUE`, uses scrambled Halton draws.}

\item{correlated}{Logical. If `TRUE`, estimates correlated random parameters
(forces all to be normally distributed).}

\item{method}{The optimization algorithm to be used by `maxLik::maxLik`.}

\item{max.iters}{Maximum number of iterations for the optimizer.}

\item{start.vals}{An optional named vector of starting values.}

\item{print.level}{Verbosity level for the optimization process (0, 1, or 2).}
}
\value{
A list object of class `rpnb` containing the model results, including
  coefficients, variance-covariance matrix, log-likelihood, and other model details.
}
\description{
Estimates a random parameters negative binomial (RPNB) model using maximum
simulated likelihood. Supports NB-1, NB-2, and NB-P specifications,
correlated or uncorrelated random parameters, various parameter distributions,
and panel data structures.
}
\examples{
\donttest{
# Assuming `washington_roads` data is available
# For a panel example, let's create a dummy panel identifier
set.seed(123)
washington_roads$county_id <- sample(1:10, nrow(washington_roads), replace = TRUE)

## Panel Data RPNB Model
panel_rp <- rpnb(
  Total_crashes ~ lnlength + lnaadt,
  rpar_formula = ~ speed50,
  data = washington_roads,
  panel = "county_id",
  form = "nb2",
  ndraws = 200
)
summary(panel_rp)
}
}
